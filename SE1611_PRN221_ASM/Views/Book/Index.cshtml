@using Repository.Entities
@model IEnumerable<Repository.Entities.Book>

@{
    ViewData["Title"] = "View";
    var pagination = ViewBag.Pagination as PaginationViewModel;
    var genres = ViewBag.Genres as List<Genre>;
    var searchModel = ViewBag.SearchModel as SearchModel;
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="holder">
    <div class="container">
        <div class="filter-row">
            <div class="row">
                <div class="items-count">@ViewBag.TotalItems item(s)</div>
                <div class="select-wrap d-none d-md-flex">
                    <div class="select-label">SORT:</div>
                    <div class="select-wrapper select-wrapper-xxs">
                        <select class="form-control input-sm" name="sort" form="filter">
                            <option value="latest">Latest</option>
                            <option value="oldest">Oldest</option>
                            <option value="rating">Rating</option>
                            <option value="price">Price</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-4 aside aside--left filter-col filter-mobile-col filter-col--sticky js-filter-col filter-col--opened-desktop" data-grid-tab-content>
                <div class="filter-col-content filter-mobile-content">
                    <div class="sidebar-block">
                        <div class="sidebar-block_title">
                            <span>Filter</span>
                        </div>
                    </div>
                    <form asp-action="Index" id="filter" method="GET">
                        @if (!String.IsNullOrEmpty(searchModel.query))
                        {
                            <input type="hidden" id="query" name="query" value="@searchModel.query"></input>
                        }
                        <div class="sidebar-block filter-group-block open">
                            <div class="sidebar-block_title">
                                <span>Genres</span>
                                <span class="toggle-arrow"><span></span><span></span></span>
                            </div>
                            <div class="sidebar-block_content">
                                <ul class="category-list clearfix">
                                    @foreach (var item in genres!)
                                    {
                                        <li>
                                            @if (ViewBag.SearchGenres != null)
                                            {
                                                <input id="@item.GenreId" name="genres" value="@item.GenreName" type="checkbox" @(searchModel.genres != null && (searchModel.genres).Contains(item.GenreName) ? "checked" : "")>
                                            }
                                            else
                                            {
                                                <input id="@item.GenreId" name="genres" value="@item.GenreName" type="checkbox">
                                            }
                                            <label for="@item.GenreId">@item.GenreName</label>
                                        </li>
                                        @*<li><a href="#" title="@item.GenreName" class="open">@item.GenreName</a></li>*@
                                    }
                                </ul>
                            </div>
                        </div>
                        <div class="sidebar-block filter-group-block open">
                            <div class="sidebar-block_title">
                                <span>Price</span>
                                <span class="toggle-arrow"><span></span><span></span></span>
                            </div>
                            <div class="sidebar-block_content">
                                <div>
                                    <label for="minPrice">Minimum Price:</label>
                                    <input type="number" id="minPrice" name="minPrice" style="padding: 8px; border-radius: 5px; border: 1px solid #ccc; font-size: 16px;" value="@searchModel.minPrice"/>
                                </div>
                                <div>
                                    <label for="maxPrice">Maximum Price:</label>
                                    <input type="number" id="maxPrice" name="maxPrice" style="padding: 8px; border-radius: 5px; border: 1px solid #ccc; font-size: 16px;" value="@searchModel.maxPrice"/>
                                </div>
                            </div>

                        </div>
                        <input class="btn" type="submit" value="Filter" />
                    </form>
                </div>
            </div>
            <div class="filter-toggle js-filter-toggle">
                <div class="loader-horizontal js-loader-horizontal">
                    <div class="progress">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" style="width: 100%"></div>
                    </div>
                </div>
                <span class="filter-toggle-icons js-filter-btn"><i class="icon-filter"></i><i class="icon-filter-close"></i></span>
                <span class="filter-toggle-text"><a href="#" class="filter-btn-open js-filter-btn">REFINE & SORT</a><a href="#" class="filter-btn-close js-filter-btn">RESET</a><a href="#" class="filter-btn-apply js-filter-btn">APPLY & CLOSE</a></span>
            </div>
            <div class="col-lg aside">
                <div class="prd-grid-wrap">
                    <div class="prd-grid product-listing data-to-show-3 data-to-show-md-3 data-to-show-sm-2 js-category-grid" data-grid-tab-content>
                        @foreach (var item in Model)
                        {
                            <div class="prd prd--style2 prd-labels--max prd-labels-shadow ">
                                <div class="prd-inside">
                                    <div class="prd-img-area">
                                        <a asp-action="Details" asp-route-id="@item.BookId" class="prd-img image-hover-scale image-container">
                                            <img src="@Html.DisplayFor(modelItem => item.ImageLink)" data-src="@Html.DisplayFor(modelItem => item.ImageLink)" alt="@Html.DisplayFor(modelItem => item.Title)" class="js-prd-img lazyload fade-up">
                                            <div class="foxic-loader"></div>
                                            <div class="prd-big-squared-labels">
                                            </div>
                                        </a>
                                        <div class="prd-circle-labels">
                                            <a href="#" class="circle-label-compare circle-label-wishlist--add js-add-wishlist mt-0" title="Add To Wishlist"><i class="icon-heart-stroke"></i></a><a href="#" class="circle-label-compare circle-label-wishlist--off js-remove-wishlist mt-0" title="Remove From Wishlist"><i class="icon-heart-hover"></i></a>
                                        </div>
                                    </div>
                                    <div class="prd-info">
                                        <div class="prd-info-wrap">
                                            <div class="prd-info-top">
                                                <div class="prd-rating"><i class="icon-star-fill fill"></i><i class="icon-star-fill fill"></i><i class="icon-star-fill fill"></i><i class="icon-star-fill fill"></i><i class="icon-star-fill fill"></i></div>
                                            </div>
                                            <div class="prd-rating justify-content-center"><i class="icon-star-fill fill"></i><i class="icon-star-fill fill"></i><i class="icon-star-fill fill"></i><i class="icon-star-fill fill"></i><i class="icon-star-fill fill"></i></div>
                                            <div class="prd-tag"><a href="#">@Html.DisplayFor(modelItem => item.Author)</a></div>
                                            <h2 class="prd-title"><a a asp-action="Details" asp-route-id="@item.BookId">@Html.DisplayFor(modelItem => item.Title)</a></h2>
                                            <div class="prd-description">
                                                @Html.DisplayFor(modelItem => item.Description)
                                            </div>
                                            <div class="prd-action">
                                                <form action="#">
                                                    <button class="btn js-prd-addtocart" data-product='{"name": "Leather Pegged Pants", "path":"images/skins/fashion/products/product-01-1.webp", "url":"product.html", "aspect_ratio":0.778}'>Add To Cart</button>
                                                </form>
                                            </div>
                                        </div>
                                        <div class="prd-hovers">
                                            <div class="prd-price">
                                                <div class="price-new">@Html.DisplayFor(modelItem => item.Price) $</div>
                                            </div>
                                            <div class="prd-action">
                                                <div class="prd-action-left">
                                                    <form action="#">
                                                        <button class="btn js-prd-addtocart" data-product='{"name": "Leather Pegged Pants", "path":"images/skins/fashion/products/product-01-1.webp", "url":"product.html", "aspect_ratio":0.778}'>Add To Cart</button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                    @if (pagination != null && pagination.TotalPages > 1)
                    {
                        <ul class="pagination" style="display: flex; justify-content: center; align-items: center;list-style: none;padding: 0;margin: 20px 0;">
                            @if (pagination.StartPage > 1)
                            {
                                <li class="@(1 == pagination.CurrentPage ? "active" : "")"><a href="?page=1&query=@searchModel.query&sort=@searchModel.sort&minprice=@searchModel.minPrice&maxprice=@searchModel.maxPrice@foreach(var g in @searchModel.genres){@($"&genres={g}")
                            }">First</a></li>
                            }
                            @for (int i = pagination.StartPage; i <= pagination.EndPage; i++)
                            {
                                <li class=" @(i == pagination.CurrentPage ? "active" : "")"><a href="?page=@i&query=@searchModel.query&sort=@searchModel.sort&minprice=@searchModel.minPrice&maxprice=@searchModel.maxPrice@foreach(var g in @searchModel.genres){@($"&genres={g}")
                            }">@i</a></li>
                            }
                            @if (pagination.EndPage < pagination.TotalPages)
                            {
                                <li class="@(pagination.TotalPages == pagination.CurrentPage ? "active" : "")"><a class="page-link" href="?page=@pagination.TotalPages&query=@searchModel.query&sort=@searchModel.sort&minprice=@searchModel.minPrice&maxprice=@searchModel.maxPrice@foreach(var g in @searchModel.genres){@($"&genres={g}")
                            }">@(pagination.TotalPages)</a></li>
                            }
                        </ul>
                    }
                    <!--<div class="mt-2">-->
                    <!--<button class="btn" onclick="THEME.loaderHorizontalSm.open()">Show Small Loader</button>-->
                    <!--<button class="btn" onclick="THEME.loaderHorizontalSm.close()">Hide Small Loader</button>-->
                    <!--</div>-->
                    <!--<div class="mt-2">-->
                    <!--<button class="btn" onclick="THEME.loaderCategory.open()">Show Opacity</button>-->
                    <!--<button class="btn" onclick="THEME.loaderCategory.close()">Hide Opacity</button>-->
                    <!--</div>-->
                </div>
            </div>
        </div>
    </div>
</div>
